<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container mt-3">
    <h4 class="display-5 text-center">Admin Dashboard</h4>

    <!-- Blood info -->
    <div class="mb-5">
      <h4 class="display-7" style="font-weight: 200;">Available blood</h4>
      <table class="table table-responsive table-hover">
        <thead>
          <tr>
            <% Object.keys(combined).forEach(data => { %>
              <th scope="col"><%= data %></th>
            <% }) %>
          </tr>
        </thead>
        <tbody style="font-weight: 200;">
          <tr>
            <% Object.values(combined).forEach((data, idx) => { %>
              <td><%= data %></td>
            <% }) %>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Blood requests -->
    <div class="mb-5">
      <h4 class="display-7" style="font-weight: 200;">Blood Requests</h4>
      <div id="requestBlood" class="alert alert-danger hide m-3" role="alert"></div>
      <table class="table table-responsive table-hover">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Hospital Name</th>
            <th scope="col">Blood Group</th>
            <th scope="col">Genotype</th>
            <th scope="col">Quantity</th>
            <th scope="col">Requested On</th>
            <th scope="col"></th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody style="font-weight: 200;">
          <% bloodRequest.forEach((data, idx) => { %>
            <tr>
              <td><%= idx + 1 %></td>
              <td><%= data['hospitalName'] %></td>
              <td><%= data['bloodGroup'] %></td>
              <td><%= data['genotype'] %></td>
              <td><%= data['quantity'] %></td>
              <td><%= new Date(data['createdAt']).getUTCDate() %> / <%= new Date(data['createdAt']).getMonth() %> / <%= new Date(data['createdAt']).getFullYear() %></td>
              <td><button class="btn btn-outline-danger" onclick="rejectRequest('<%= data._id %>')">Reject</button></td>
              <td><button class="btn btn-outline-success" onclick="approveRequest('<%= data._id %>')">Approve</button></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>


    <!-- Blood donations -->
    <div class="mb-5">
      <h4 class="display-7" style="font-weight: 200;">Blood Donations Requests</h4>
      <div id="bloodDonation" class="alert alert-danger hide m-3" role="alert"></div>
      <table class="table table-responsive table-hover">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Full Name</th>
            <th scope="col">Blood Group</th>
            <th scope="col">Genotype</th>
            <th scope="col">Quantity</th>
            <th scope="col">State</th>
            <th scope="col">Center</th>
            <th scope="col">Requested On</th>
            <th scope="col"></th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody style="font-weight: 200;">
          <% donationRequest.forEach((data, idx) => { %>
            <tr>
              <td><%= idx + 1 %></td>
              <td><%= data['fullName'] %></td>
              <td><%= data['bloodGroup'] %></td>
              <td><%= data['genotype'] %></td>
              <td><%= data['quantity'] %></td>
              <td><%= data['state'] %></td>
              <td><%= data['center'] %></td>
              <td><%= new Date(data['createdAt']).getUTCDate() %> / <%= new Date(data['createdAt']).getMonth() %> / <%= new Date(data['createdAt']).getFullYear() %></td>
              <td><button class="btn btn-outline-danger" onclick="rejectDonation('<%= data._id %>')">Reject</button></td>
              <td><button class="btn btn-outline-success" onclick="approveDonation('<%= data._id %>')">Approve</button></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

    <!-- Hospitals -->
    <div class="mb-5">
      <h4 class="display-7" style="font-weight: 200;">Registered Hospitals</h4>
      <div id="bloodDonation" class="alert alert-danger hide m-3" role="alert"></div>
      <table class="table table-responsive table-hover">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Hospital Name</th>
            <th scope="col">Email</th>
            <th scope="col">Address</th>
            <th scope="col">State</th>
          </tr>
        </thead>
        <tbody style="font-weight: 200;">
          <% hospitals.forEach((data, idx) => { %>
            <tr>
              <td><%= idx + 1 %></td>
              <td><%= data['hospitalName'] %></td>
              <td><%= data['email'] %></td>
              <td><%= data['address'] %></td>
              <td><%= data['state'] %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

    <!-- Donors -->
    <div class="mb-5">
      <h4 class="display-7" style="font-weight: 200;">Registered Donors</h4>
      <div id="bloodDonation" class="alert alert-danger hide m-3" role="alert"></div>
      <table class="table table-responsive table-hover">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Full Name</th>
            <th scope="col">Email</th>
            <th scope="col">Phone</th>
            <th scope="col">Age</th>
            <th scope="col">Blood Group</th>
            <th scope="col">Genotype</th>
          </tr>
        </thead>
        <tbody style="font-weight: 200;">
          <% donors.forEach((data, idx) => { %>
            <tr>
              <td><%= idx + 1 %></td>
              <td><%= data['fullName'] %></td>
              <td><%= data['email'] %></td>
              <td><%= data['phone'] %></td>
              <td><%= data['age'] %></td>
              <td><%= data['bloodGroup'] %></td>
              <td><%= data['genotype'] %></td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/admin.js"></script>
</body>
</html>